LOWER_CASE = (
    '`', '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', '-', '=',
    'q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', '[', ']', '\\',
    'a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', ';', '\'',
    'z', 'x', 'c', 'v', 'b', 'n', 'm', ',', '.', '/')

UPPER_CASE = (
    '~', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+',
    'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', '{', '}', '|',
    'A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L', ':', '"',
    'Z', 'X', 'C', 'V', 'B', 'N', 'M', '<', '>', '?')

ADJACENCY_MAP = {
    '`': ('`', '1', 'q',
          '~', '!', 'Q'),
    '1': ('1', '2', 'w', 'q', '`',
          '!', '@', 'W', 'Q', '~'),
    '2': ('2', '3', 'e', 'w', 'q', '1',
          '@', '#', 'E', 'W', 'Q', '!'),
    '3': ('3', '4', 'r', 'e', 'w', '2',
          '#', '$', 'R', 'E', 'W', '@'),
    '4': ('4', '5', 't', 'r', 'e', '3',
          '$', '%', 'T', 'R', 'E', '#'),
    '5': ('5', '6', 'y', 't', 'r', '4',
          '%', '^', 'Y', 'T', 'R', '$'),
    '6': ('6', '7', 'u', 'y', 't', '5',
          '^', '&', 'U', 'Y', 'T', '%'),
    '7': ('7', '8', 'i', 'u', 'y', '6',
          '&', '*', 'I', 'U', 'Y', '^'),
    '8': ('8', '9', 'o', 'i', 'u', '7',
          '*', '(', 'O', 'I', 'U', '&'),
    '9': ('9', '0', 'p', 'o', 'i', '8',
          '(', ')', 'P', 'O', 'I', '*'),
    '0': ('0', '-', '[', 'p', 'o', '9',
          ')', '_', '{', 'P', 'O', '('),
    '-': ('-', '=', ']', '[', 'p', '0',
          '_', '+', '}', '{', 'P', ')'),
    '=': ('=', '\\', ']', '[', '-',
          '+', '|', '}', '{', '_'),
    
    'q': ('q', '`', '1', '2', 'w', 's', 'a',
          'Q', '~', '!', '@', 'W', 'S', 'A'),
    'w': ('w', '1', '2', '3', 'e', 'd', 's', 'a', 'q',
          'W', '!', '@', '#', 'E', 'D', 'S', 'A', 'Q'),
    'e': ('e', '2', '3', '4', 'r', 'f', 'd', 's', 'w',
          'E', '@', '#', '$', 'R', 'F', 'D', 'S', 'W'),
    'r': ('r', '3', '4', '5', 't', 'g', 'f', 'd', 'e',
          'R', '#', '$', '%', 'T', 'G', 'F', 'D', 'E'),
    't': ('t', '4', '5', '6', 'y', 'h', 'g', 'f', 'r',
          'T', '$', '%', '^', 'Y', 'H', 'G', 'F', 'R'),
    'y': ('y', '5', '6', '7', 'u', 'j', 'h', 'g', 't',
          'Y', '%', '^', '&', 'U', 'J', 'H', 'G', 'T'),
    'u': ('u', '6', '7', '8', 'i', 'k', 'j', 'h', 'y',
          'U', '^', '&', '*', 'I', 'K', 'J', 'H', 'Y'),
    'i': ('i', '7', '8', '9', 'o', 'l', 'k', 'j', 'u',
          'I', '&', '*', '(', 'O', 'L', 'K', 'J', 'U'),
    'o': ('o', '8', '9', '0', 'p', ';', 'l', 'k', 'i',
          'O', '*', '(', ')', 'P', ':', 'L', 'K', 'I'),
    'p': ('p', '9', '0', '-', '[', "'", ';', 'l', 'o',
          'P', '(', ')', '_', '{', '"', ':', 'L', 'O'),
    '[': ('[', '0', '-', '=', ']', "'", ';', 'p',
          '{', ')', '_', '+', '}', '"', ':', 'P'),
    ']': (']', '-', '=', '\\', "'", '[',
          '}', '_', '+', '|', '"', '{'),
    '\\': ('\\', '=', ']',
           '|', '+', '}'),
    'a': ('a', 'q', 'w', 's', 'x', 'z',
          'A', 'Q', 'W', 'S', 'X', 'Z'),
    's': ('s', 'q', 'w', 'e', 'd', 'c', 'x', 'z', 'a',
          'S', 'Q', 'W', 'E', 'D', 'C', 'X', 'Z', 'A'),
    'd': ('d', 'w', 'e', 'r', 'f', 'v', 'c', 'x', 's',
          'D', 'W', 'E', 'R', 'F', 'V', 'C', 'X', 'S'),
    'f': ('f', 'e', 'r', 't', 'g', 'b', 'v', 'c', 'd',
          'F', 'E', 'R', 'T', 'G', 'B', 'V', 'C', 'D'),
    'g': ('g', 'r', 't', 'y', 'h', 'n', 'b', 'v', 'f',
          'G', 'R', 'T', 'Y', 'H', 'N', 'B', 'V', 'F'),
    'h': ('h', 't', 'y', 'u', 'j', 'm', 'n', 'b', 'g',
          'H', 'T', 'Y', 'U', 'J', 'M', 'N', 'B', 'G'),
    'j': ('j', 'y', 'u', 'i', 'k', ',', 'm', 'n', 'h',
          'J', 'Y', 'U', 'I', 'K', '<', 'M', 'N', 'H'),
    'k': ('k', 'u', 'i', 'o', 'l', '.', ',', 'm', 'j',
          'K', 'U', 'I', 'O', 'L', '>', '<', 'M', 'J'),
    'l': ('l', 'i', 'o', 'p', ';', '/', '.', ',', 'k',
          'L', 'I', 'O', 'P', ':', '?', '>', '<', 'K'),
    ';': (';', 'o', 'p', '[', "'", '/', '.', 'l',
          ':', 'O', 'P', '{', '"', '?', '>', 'L'),
    "'": ("'", 'p', '[', ']', '/', ';',
          '"', 'P', '{', '}', '?', ':'),
    
    'z': ('z', 'a', 's', 'x',
          'Z', 'A', 'S', 'X'),
    'x': ('x', 'a', 's', 'd', 'c', 'z',
          'X', 'A', 'S', 'D', 'C', 'Z'),
    'c': ('c', 's', 'd', 'f', 'v', 'x',
          'C', 'S', 'D', 'F', 'V', 'X'),
    'v': ('v', 'd', 'f', 'g', 'b', 'c',
          'V', 'D', 'F', 'G', 'B', 'C'),
    'b': ('b', 'f', 'g', 'h', 'n', 'v',
          'B', 'F', 'G', 'H', 'N', 'V'),
    'n': ('n', 'g', 'h', 'j', 'm', 'b',
          'N', 'G', 'H', 'J', 'M', 'B'),
    'm': ('m', 'h', 'j', 'k', ',', 'n',
          'M', 'H', 'J', 'K', '<', 'N'),
    ',': (',', 'j', 'k', 'l', '.', 'm',
          '<', 'J', 'K', 'L', '>', 'M'),
    '.': ('.', 'k', 'l', ';', '/', ',',
          '>', 'K', 'L', ':', '?', '<'),
    '/': ('/', 'l', ';', "'", '.',
          '?', 'L', ':', '"', '>'),

    ' ': (' ', 'x', 'c', 'v', 'b', 'n', 'm', ',',
               'X', 'C', 'V', 'B', 'N', 'M', '<'),
}

for lc, uc in zip(LOWER_CASE, UPPER_CASE):
    ADJACENCY_MAP[uc] = ADJACENCY_MAP[lc]


class QwertyValidator:
    adjacency_map = ADJACENCY_MAP
    lower_case = LOWER_CASE
    upper_case = UPPER_CASE

    def compare_adjacency(self, previous, next_):
        if next_ in self.adjacency_map[previous]:
            return -0.5
        return 0.5

    def compare_cases(self, previous, next_):
        if previous in self.lower_case:
            if next_ in self.upper_case:
                return 0.5
            elif next_ in self.lower_case:
                return -0.5
        elif previous in self.upper_case:
            if next_ in self.lower_case:
                return 0.25
            elif next_ in self.upper_case:
                return -0.25
        raise ValueError

    def validate(self, secret: str):
        complexity_count = len(secret)
        for previous, next_ in zip(secret[0:-1], secret[1:]):
            complexity_count += self.compare_adjacency(previous, next_)
            complexity_count += self.compare_cases(previous, next_)
        return complexity_count
